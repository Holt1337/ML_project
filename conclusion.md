# Выводы по результатам ДЗ1
Цель работы заключалась в обучении модели регресси для предсказания стоимости автомобилей на основе имеющихся данных  таблице 'cars_train.csv'.
## Часть 1 Простейший EDA и обработка признаков
В двнной части производился анализ данных таблиц 'cars_train.csv' и 'cars_test.csv', преобразование столбцов 'mileage', 'engine', 'max_power' к типу float, удаление дубликатов из train выборки, 
разбиение столбца 'torque' на 'torque' и 'max_torque_rpm', а также заполнение пропусков средним значением по столбцу. 

Далее были построены графики кореляции признаков между собой и с целевой переменной, 
на основе которых были сделаны выводы о прямой свзи целевой переменной со следующими признаками: year, mileage, engine, max_power.
Также было сделано предположение об обратной зависимости между ценой на автомобиль и количеством владельцев. Была установлена кореляция между признаками engine - max_power и отрицательная кореляция между years - km_driven.
На основе тепловой карты были выявлены пары наименее корелирующих признаков (engine-year, max_torque_rnd-torque, max_torque_rnd-selling_price).

В дополнении были построены гистограммы категориальных признаков с зависимостью от целевого признака. Были получены следующие закономерности: на основе гистограммы признака seller_type можно сказать, что значениям столбцов Dealer и Trustmark Dealer в большей степени соответсвует высокая цена. По гистограммам признаков transmission, owner, seats видно, что большинство машин выставленных на продажу имеют ручную коробку передач или одного владельца, большинство машин имеют посадочных мест.

## Часть 2  Модель только на вещественных признаках
В данной части производилось обучение моделей регрессии только на вещественных данных.
Для начала была взята модель Линейной регресии с дефолтными параметрами. На основе метрик были сделаны выводы о низком качестве такой модели. По метрики R2 для трейна было получено 0.592, тест - 0.594, MSE - 116874153930 и 233298779730 соответственно.
После стандартизации признаков качество модели незначительно улучшилось для тестовой выборки (R2 - 0.565 ), было установлено, что наиболее информативным признаком является максимальная мощность.

Следующим шагом было использование Lasso-регрессии. При помощи GridSearchCV с 10-ю фолдами были подобраны оптимальные параметры модели, при которых происходило зануление признака seats (предполагается, что это связано с преобладающим значением 5 в столбце).
Также были подобраны оптимальные параметры для ElasticNet-регрессии (R2 - 0.589 , 0.551; MSE - 117736652875, 257538314648 для трейне и теста соответственно).

## Часть 3 Модель с добавлением категориальных признаков
Для обучение модели с категориальными признаками было необходимо произвести кодирование категориальных признаков методом One Hot Encoding.
В качестве модели использовалась Ridge-регрессия, на которой с оптимальными параметрами были получены следующие результаты: R2 - 0.657 для трейна, 0.569 для теста.

## Часть 4 Бонусная
Была пропущена из-за ограниченности времени))

## Часть Бизнесовая
Была реализована метрика отображающая долю предиктов, отличающихся от реальных цен на эти авто не более чем на 10%.
В результате тестирования лучшей модели было получено значение 24.2%.

## Часть 5 Реализация сервиса на FastAPI
Был реализован сервис на FastAPI, который реализует следующие функции:
- на вход в формате json подаются признаки одного объекта, на выходе сервис выдает предсказанную стоимость машины

- на вход подается csv-файл с признаками тестовых объектов, на выходе получаем файл с +1 столбцом - предсказаниями на этих объектах
